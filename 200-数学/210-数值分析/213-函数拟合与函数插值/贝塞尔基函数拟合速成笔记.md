# 贝塞尔基函数拟合速成笔记

> tags: #Bessel-Function; #Gamma-Function; #PDE; #Fitting; #Interpolation; #Fourier-Transform

### TL; DR

* 空间中的时域函数通过傅里叶变换得到其频域函数，反之亦然；
* 极坐标函数在变量分离的假设下，天然适合做三角级数展开；
* 圆采样基函数与傅里叶贝塞尔基函数二者差一次傅里叶变换，可借助傅里叶变换的性质做频率截断；

### 前期知识储备

> 数学名词缩写：定义 Definition -> Def，定理 Theorem -> Thm, 推论 Corollary -> Cor

* 数学特殊函数：Gamma function (definition); Dirac delta function (definition, integral property);
  * 一般记 $\Gamma(z)$ 表示伽马函数，其定义与常用性质为
    * **\[Def 0.1.1\]** 函数定义
      $$
      \Gamma(z) = \int_{0}^{\infty} t^{z-1} {\mathrm e}^{-t} {{\mathrm d}} t, z \in {\mathbb C}
      $$
    * **\[Thm 0.1.2\]** 递推关系
      $$
      \begin{aligned} \Gamma(x) &= x \Gamma(x - 1), x \in {\mathbb R} \\ \Gamma(n) &= (n - 1)!, n \in {\mathbb Z} \end{aligned}
      $$
  * 一般记 $\delta(x)$ 表示 Dirac-delta 函数，其定义近似满足如下形式，且常用性质为
    * **\[Def 0.2.1\]** 函数定义
      $$
      \delta(x) \simeq \begin{cases} +\infty, & x = 0, \\ 0, & x \ne 0. \end{cases}
      $$
      同时要求函数在全域上积分为 1，即
      $$
      \int_{-\infty}^{\infty} \delta(x) {\mathrm d} x = 1
      $$
    * **\[Thm 0.2.2\]** 平移性质
      $$
      \int_{-\infty}^{\infty} f(x) \delta(x - a) {\mathrm d} x = f(a)
      $$
* 积分技巧：Changing the order of integration; Multiple integral;

## 贝塞尔函数定义

第一类贝塞尔函数（Bessel function of the first kind）是如下 ODE 在满足参数 $\nu \geq 0$ 或 $\nu \in {\mathbb Z}$ 时的解，ODE 的形式如下所示

$$
x^2 \frac{{\mathrm d}^2 y}{{\mathrm d}x^2} + x \frac{{\mathrm d} y}{{\mathrm d}x} + (x^2 - \nu^2) y = 0
$$

令 $J_{\nu}(x)$ 表示 $\nu$ 阶第一类贝塞尔函数，其幂级数展开为

$$
J_{\nu}(x) = \sum_{m=0}^{\infty} \frac{(-1)^m}{m!\Gamma(m + \nu + 1)}
\Bigl( \frac{x}{2} \Bigr)^{2m + \nu}
$$

其中，$\Gamma(z)$ 为伽马函数。当 $\nu \in {\mathbb Z}$ 时，也常用 $J_n(x)$ 代指 $n$ 阶贝塞尔函数，借助伽马函数的性质，其定义可写做

$$
J_{n}(x) = \sum_{m=0}^{\infty} \frac{(-1)^m}{m!(m + n)!}
\Bigl( \frac{x}{2} \Bigr)^{2m + n}
$$

除幂级数展开之外，其积分定义为

$$
J_{\nu}(x) = \frac{1}{\pi} \int_{-\pi}^{\pi} \cos \bigl[ \nu \tau - x \sin \tau \bigr] {\mathrm d} \tau - \frac{\sin \nu \pi}{\pi} \int_{0}^{\infty} \exp \bigl\{ -x \sinh t - \nu t \bigr\} {\mathrm d} t
$$

类似地，当 $\nu \in {\mathbb Z}$ 时，由欧拉公式 $\exp {\mathrm i} \omega \theta = \cos \omega \theta + {\mathrm i} \sin \omega \theta$ 可知

$$
J_{\nu}(x) = \frac{1}{2\pi} \int_{-\pi}^{\pi} \exp \Bigl\{ {\mathrm i} \bigl[ \nu \tau - x \sin \tau \bigr] \Bigr\} {\mathrm d} \tau
$$

$$
J_{\nu}(x) = \frac{1}{2\pi} \int_{0}^{2\pi} \cos \bigl( \nu \tau - x \sin \tau \bigr) {\mathrm d} \tau
$$

## 贝塞尔函数性质


### 线性相关性

* **\[Thm 2.1.1\]** 当 $n \in {\mathbb Z}$ 时，由定义可推导出贝塞尔函数的线性相关性质
   $$
   J_{-n}(x) = (-1)^{n} J_{n}(x)
   $$
* **\[Cor 2.1.2\]**
   $$
   \begin{aligned} J_{2k}(x) &= J_{-2k}(x) \\ J_{2k+1}(x) &= -J_{-2k-1}(x) \end{aligned}
   $$

### 微分性质

* **\[Thm 2.2.1\]**
   $$
   \frac{{\mathrm d}}{{\mathrm d} x}\bigl( x^{n} J_{n}(x) \bigr) = x^{n} J_{n-1}(x)
   $$
* **\[Thm 2.2.2\]**
   $$
   \frac{{\mathrm d}}{{\mathrm d} x}\bigl( x^{-n} J_{n}(x) \bigr) = -x^{-n} J_{n+1}(x)
   $$
* **\[Thm 2.2.3\]**
   $$
   x J_{n}'(x) + n J_{n}(x) = x J_{n-1}(x)
   $$
* **\[Thm 2.2.4\]**
   $$
   x J_{n}'(x) - n J_{n}(x) = -x J_{n+1}(x)
   $$

### 递推性质

* **\[Thm 2.3.1\]**
   $$
   J_{n-1}(x) + J_{n+1}(x) = \frac{2n}{x} J_{n}(x)
   $$
* **\[Thm 2.3.2\]**
   $$
   J_{n-1}(x) - J_{n+1}(x) = 2 J_{n}'(x)
   $$

### 微分数值计算

* **\[Thm 2.4.1\]**
   $$
   J_{n}'(x) = \frac{n}{x} J_{n}(x) - J_{n+1}(x)
   $$
* **\[Thm 2.4.2\]**
   $$
   J_{n}''(x) = \frac{{\mathrm d}}{{\mathrm d} x} \Bigl[ \frac{n}{x} J_{n}(x) - J_{n+1}(x) \Bigr]= \frac{1}{x^2} \Bigl[ (n^2 - n - x^2) J_{n}(x) + x J_{n+1}(x) \Bigr]
   $$
* **\[Cor 2.4.3\]**: 由 **\[Thm 2.2.4\]** 与 **\[Thm 2.4.2\]** 可知
   $$
   J_{n}''(x) = \Bigr( \frac{n^2}{x^2} - 1 \Bigr) J_{n}(x) - \frac{1}{x} J_{n}'(x)
   $$

### 正交性

* **\[Thm 2.5.1\]** 有界域内积
   $$
   \int_{0}^{\alpha} x J_n(kx) J_n(lx) {\mathrm d} x = \frac{\alpha}{k^2 - l^2} \bigl[ k J_{n+1}(k\alpha) J_{n}(l\alpha) - l J_{n+1}(l\alpha) J_{n}(k\alpha) \bigr]
   $$

   $$
   \lim_{l \to k}\int_{0}^{\alpha} x J_n(kx) J_n(lx) {\mathrm d} x = \frac{\alpha^2}{2} J_{n+1}^2(k\alpha)
   $$
* **\[Thm 2.5.2\]** 有界域正交性：令 $k = \lambda_{ns} / \alpha$ $l = \lambda_{nt} / \alpha$ $J_{n}(\lambda_{ns}) = J_{n}(\lambda_{nt}) = 0$
   $$
   \int_{0}^{\alpha} r J_n\Bigl(\lambda_{ns} \frac{r}{\alpha}\Bigr) J_n\Bigl(\lambda_{nt} \frac{r}{\alpha}\Bigr) {\mathrm d} r = \frac{\alpha^2}{2} J_{n+1}^2(\lambda_s) \delta_{st}
   $$

* **\[Thm 2.5.3\]** 无穷积分正交性

   $$
   \int_{0}^{\infty} x J_v(u x) J_v(v x) {\mathrm d} x = \frac{1}{u} \delta(u - v), v \geq - \frac12
   $$

   其中 $\delta(x)$ 为 Dirac-delta 函数。

### 函数零点

* 固定点迭代
   $$
   x_{i + 1} = x_i - \frac{J_n(x_i)}{J_n'(x_i)} = x_i - \frac{x_i J_n(x_i)}{n J_n(x_i) - x_i J_{n + 1}(x_i)}
   $$
* Halley 方法<a name="rref1"></a>\[[1](#ref1)\]
   $$
   x_{i + 1} = x_i - \frac{2 J_\nu(x_i) J_\nu'(x_i) }{ 2 [J_\nu'(x_i)]^2 - J_\nu(x_i) J_\nu''(x_i) }
   $$

   $$
   \begin{aligned}
   J_\nu(x) J_\nu'(x) &= J_\nu(x) \left[ \frac{\nu}{x} J_\nu(x) - J_{\nu + 1}(x) \right] = \frac{1}{x^2} x J_\nu(x) \left[ \nu J_\nu(x) - x J_{\nu + 1}(x) \right] \\
   [J_\nu'(x)]^2 &= \frac{\nu^2}{x^2} J_\nu(x) - \frac{2\nu}{x} J_\nu(x) J_{\nu + 1}(x) + [J_{\nu + 1}(x)]^2 \\
   &= \frac{1}{x^2} \left[ \nu^2 J_\nu(x) - 2\nu x J_\nu(x) J_{\nu + 1}(x) + x^2 [J_{\nu + 1}(x)]^2 \right] \\
   J_\nu(x) J_\nu''(x) &= \frac{1}{x^2} \left\{ (\nu^2 - \nu - x^2) [J_\nu(x)]^2 + x J_\nu(x) J_{\nu + 1}(x) \right\}
   \end{aligned}
   $$

## 一元函数的贝塞尔函数展开与函数拟合

$$
f(r) = \sum_{s=1}^{+\infty} b_s J_n \Bigl( \frac{\lambda_{ns}}{\alpha} r \Bigr)
$$

$J_n \Bigl( \frac{\lambda_{ns}}{\alpha} r \Bigr)$ $\lambda_{ns}$ $r \in (0, \alpha)$

$$
\begin{aligned}
I_s &= \left\langle r f(r), J_n \Bigl( \frac{\lambda_{ns}}{\alpha} r \Bigr)\right\rangle \\
&= \sum_{t=1}^{+\infty} b_t \int_{0}^{\alpha} r J_n \Bigl( \frac{\lambda_{nt}}{\alpha} r \Bigr) J_n \Bigl( \frac{\lambda_{ns}}{\alpha} r \Bigr) {\mathrm d} r \\
&= b_s \frac{\alpha^2}{2} J_{n+1}^2(\lambda_{ns})
\implies b_s = \frac{2}{\alpha^2} J_{n+1}^{-2}(\lambda_{ns}) I_s
\end{aligned}
$$

$$
y_i = f(r_i) = \sum_{s=1}^{N_R} b_s J_n \Bigl( \frac{\lambda_{ns}}{\alpha} r_1 \Bigr) \implies {\boldsymbol y} = (y_i)
$$

$N_R$

$$
\phi_{ins} = J_n \Bigl( \frac{\lambda_{ns}}{\alpha} r_i \Bigr) \implies {\mathbf \Phi}_n = (\phi_{ins})
$$

$$
{\mathbf A}^{\dagger} = ({\mathbf A}^{\text{T}} {\mathbf A})^{-1} {\mathbf A}^{\text{T}}
$$

$$
{\boldsymbol b} = (b_s)
$$

$$
y_i = \phi_{ins} b_s \implies {\boldsymbol y} = {\mathbf \Phi}_n {\boldsymbol b} \implies {\boldsymbol b} = {\mathbf \Phi}_n^{\dagger} {\boldsymbol y}
$$

## 圆域上贝塞尔函数展开

$$
f(r, \theta) = \sum_{n=-\infty}^{+\infty} \sum_{s=1}^{+\infty} b_{ns} {\mathrm e}^{{\mathrm i} n \theta} J_n\Bigl( \frac{\lambda_{ns}}{\alpha} r \Bigr)
$$

$$
\begin{aligned}
I_{ns} &= \left\langle r f(r, \theta), {\mathrm e}^{{\mathrm i} n \theta} J_n \Bigl( \frac{\lambda_{ns}}{\alpha} r \Bigr)\right\rangle \\
&= \sum_{m=-\infty}^{+\infty} \sum_{t=1}^{+\infty} b_{mt} \int_{0}^{\alpha} \int_{0}^{2\pi} {\mathrm e}^{{\mathrm i} m \theta} {\mathrm e}^{{\mathrm i} n \theta} r J_m \Bigl( \frac{\lambda_{mt}}{\alpha} r \Bigr) J_n \Bigl( \frac{\lambda_{ns}}{\alpha} r \Bigr) {\mathrm d} r {\mathrm d} \theta \\
&= \sum_{m=-\infty}^{+\infty} \sum_{t=1}^{+\infty} b_{mt} \delta_{st} \delta_{mn} \int_{0}^{2\pi} {\mathrm e}^{{\mathrm i} m \theta} {\mathrm e}^{{\mathrm i} n \theta} \frac{\alpha^2}{2} J_{n+1}^{2}(\lambda_{ns}) {\mathrm d} \theta \\
&= \sum_{m=-\infty}^{+\infty} b_{ms} \frac{\alpha^2}{2} J_{n+1}^{2}(\lambda_{ns}) \int_{0}^{2\pi} {\mathrm e}^{{\mathrm i} m \theta} {\mathrm e}^{{\mathrm i} n \theta}  {\mathrm d} \theta \\
&= \sum_{m=-\infty}^{+\infty} b_{ms} \frac{\alpha^2}{2} J_{n+1}^{2}(\lambda_{ns}) \delta_{mn} (2 \pi) \\
&= b_{ns} \pi \alpha^2 J_{n+1}^{2}(\lambda_{ns})
\implies b_{ns} = \frac{1}{\pi \alpha^2} J_{n+1}^{-2}(\lambda_{ns}) I_{ns}
\end{aligned}
$$


$$
y_{ij} = f(r_i, \theta_j) = \sum_{n=-N_A}^{N_A} \sum_{s=1}^{N_R} b_{ns} {\mathrm e}^{{\mathrm i} n \theta_j} J_n\Bigl( \frac{\lambda_{ns}}{\alpha} r_i \Bigr) \implies {\mathbf Y} = (y_{ij})
$$



$N_A$ $N_R$

$$
\phi_{ijns} = {\mathrm e}^{{\mathrm i} n \theta_j} J_n \Bigl( \frac{\lambda_{ns}}{\alpha} r_i \Bigr) \implies {\mathbf \Phi} = (\phi_{ijns})
$$

$$
{\mathbf A}^{\dagger} = ({\mathbf A}^{\text{T}} {\mathbf A})^{-1} {\mathbf A}^{\text{T}}
$$

$$
{\mathbf B} = (b_{ns})
$$

$$
y_{ij} = \phi_{ijns} b_{ns} \implies {\mathbf Y} = {\mathbf \Phi} : {\mathbf B}
$$

$$
\tilde{\mathbf \Phi} := {\mathrm{reorder}}({\mathbf \Phi}) = (\phi_{(ij)(ns)})
$$

$$
\implies {\mathrm{vec}}({\mathbf B}) = \tilde{\mathbf \Phi}^{\dagger} {\mathrm{vec}}({\mathbf Y})
$$

## 圆采样基函数

$$
f(r, \theta) := \sum_{n=-\infty}^{+\infty} c_n(r) {\mathrm e}^{{\mathrm i} n \theta}
$$

$$
\begin{aligned}
F(\rho, \varphi) &:= {\mathscr F}[f(r, \theta)] \\
&= 2 \pi \sum_{n=-\infty}^{+\infty} \biggl( \int_{0}^{\infty} r c_n(r) J_n(r \rho) {\mathrm d} r \biggr) {\mathrm e}^{{\mathrm i} n \bigl( \varphi - \frac{\pi}{2} \bigr)} \\
&= 2 \pi \sum_{n=-\infty}^{+\infty} \overline{c}_{nn}(\rho) {\mathrm e}^{{\mathrm i} n \bigl( \varphi - \frac{\pi}{2} \bigr)}
\end{aligned}
$$

$$
\overline{c}_{nn}(\rho) := \int_{0}^{\infty} r c_n(r) J_n(r \rho) {\mathrm d} r = {\mathscr H}_n[c_n(r)]
$$

$$
\begin{aligned}
\overline{c}_{nn}(\rho) &:= {\mathscr H}_n[c_n(r)] \\
c_n(r) &:= {\mathscr H}_n[\overline{c}_{nn}(\rho)]
\end{aligned}
$$

$$
\overline{c}_{nn}(\rho) := \sum_{s=1}^{+\infty} \frac{2 c_n\bigl( \frac{\lambda_{ns}}{\alpha} \bigr)}{\alpha^2 J_{n+1}^2(\lambda_{ns})} J_n\Bigl( \frac{\lambda_{ns}}{\alpha} \rho \Bigr)
$$

$$
\implies \overline{c}_{nn}(\rho) = \sum_{s=1}^{+\infty} c_n\Bigl( \frac{\lambda_{ns}}{\alpha} \Bigr) \frac{2}{\alpha^2 J_{n+1}^2(\lambda_{ns})} J_n\Bigl( \frac{\lambda_{ns}}{\alpha} \rho \Bigr)
$$


$$
b_{ns} := c_n\Bigl( \frac{\lambda_{ns}}{\alpha} \Bigr) \frac{2}{\alpha^2 J_{n+1}^2(\lambda_{ns})}
$$

$$
\implies F(\rho, \varphi) = 2 \pi \sum_{n=-\infty}^{+\infty} \sum_{s=1}^{+\infty} b_{ns} {\mathrm e}^{{\mathrm i} n \bigl( \varphi - \frac{\pi}{2} \bigr)} J_n\Bigl( \frac{\lambda_{ns}}{\alpha} \rho \Bigr)
$$

$$
\begin{aligned}
c_n(r) &:= {\mathscr H}_n[\overline{c}_{nn}(\rho)] \\
&= \sum_{s=1}^{+\infty} c_n\Bigl( \frac{\lambda_{ns}}{\alpha} \Bigr)
\frac{2 \lambda_{ns}}{\lambda_{ns}^2 - \alpha^2 r^2}
\frac{J_n(\alpha r)}{J_{n+1}(\lambda_{ns})} \\
&= \sum_{s=1}^{+\infty} c_{ns} u_{ns}(r)
\end{aligned}
$$

$$
\begin{aligned}
c_{ns} &:= c_n\Bigl( \frac{\lambda_{ns}}{\alpha} \Bigr)\\
u_{ns}(r) &:=
\frac{2 \lambda_{ns}}{\lambda_{ns}^2 - \alpha^2 r^2}
\frac{J_n(\alpha r)}{J_{n+1}(\lambda_{ns})}
\end{aligned}
$$

$$
\implies f(r, \theta) = \sum_{n=-\infty}^{+\infty} \sum_{s=1}^{+\infty} c_{ns} {\mathrm e}^{{\mathrm i} n \theta} u_{ns}(r)
$$

## 基函数的归一化处理

### 圆域上贝塞尔归一化基函数

### 圆采样贝塞尔归一化基函数

## 参考文档

<a name="ref1">\[1\]</a>[^](#rref1) Halley's method - Wikipedia <https://en.wikipedia.org/wiki/Halley's_method>
